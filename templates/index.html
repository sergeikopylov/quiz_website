<!DOCTYPE html>
<html>
<head>
    <title>Новогодняя Викторина</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        body {
            font-family: 'Courier New', Courier, monospace;
            text-align: center;
            background-color: #2c3e50; /* Dark background */
            color: white;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* --- LOGIN SCREEN (UPDATED) --- */
        #login-screen {
            display: flex;
            flex-direction: column;
            gap: 30px; /* More space between items */
            width: 80%;
            max-width: 600px;
        }

        #login-screen h1 {
            font-size: 60px; /* Big Title */
            margin-bottom: 20px;
        }

        #username {
            padding: 25px;
            font-size: 40px; /* Giant Input Text */
            text-align: center;
            border-radius: 10px;
            border: none;
        }

        .enter-btn {
            padding: 25px;
            font-size: 35px; /* Giant Button Text */
            cursor: pointer;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: bold;
        }

        /* --- MAIN SCREEN --- */
        #main-screen { display: none; width: 100%; height: 100%; flex-direction: column; align-items: center; justify-content: center; }

        #status-text {
            font-size: 30px;
            margin-bottom: 20px;
            height: 40px;
        }

        /* THE BUTTON STATES */
        #the-button {
            width: 80%;
            height: 50vh;
            font-size: 40px;
            font-weight: bold;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            color: white;
            box-shadow: 0 10px 0 rgba(0,0,0,0.2);
        }

        .btn-ready { background-color: #27ae60; }
        .btn-ready:active { transform: translateY(5px); box-shadow: 0 5px 0 rgba(0,0,0,0.2); }
        .btn-locked { background-color: #7f8c8d; cursor: not-allowed; }
        .btn-winner { background-color: #f1c40f; color: black; }

        .btn-sergei {
            width: auto !important;
            height: auto !important;
            padding: 20px 40px;
            background-color: #e74c3c;
        }
    </style>
</head>
<body>

    <div id="login-screen">
        <h1>Добро пожаловать на новогоднюю викторину от Сережи и Зои</h1>
        <input type="text" id="username" placeholder="Введите Имя">
        <button class="enter-btn" onclick="enterApp()">Начать игру</button>
    </div>

    <div id="main-screen">
        <div id="status-text"></div>
        <button id="the-button" class="btn-ready" onclick="sendClick()">ОТВЕТИТЬ!</button>
    </div>

    <script>
        var socket = io();
        var currentUser = "";
        var buzzSound = new Audio('https://cdn.freesound.org/previews/366/366104_6687700-lq.mp3');

        function enterApp() {
            var name = document.getElementById('username').value.trim();
            if (!name) return;
            currentUser = name;

            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('main-screen').style.display = 'flex';

            if (currentUser === "Sergei") {
                var btn = document.getElementById('the-button');
                btn.innerText = "RESET CYCLE";
                btn.className = "btn-sergei";
            }
        }

        function sendClick() {
            socket.emit('user_clicked', {name: currentUser});
        }

        socket.on('game_locked', function(data) {
            var btn = document.getElementById('the-button');
            var status = document.getElementById('status-text');

            buzzSound.currentTime = 0;
            buzzSound.play();

            if (currentUser === "Sergei") {
                status.innerText = "LOCKED BY: " + data.winner;
            } else {
                if (data.winner === currentUser) {
                    btn.className = "btn-winner";
                    btn.innerText = "ТЫ ОТВЕЧАЕШЬ!";
                    status.innerText = "";
                } else {
                    btn.className = "btn-locked";
                    btn.innerText = "ОТВЕЧАЕТ" + " " + data.winner;
                    btn.disabled = true;
                    status.innerText = "";
                }
            }
        });

        socket.on('game_reset', function(data) {
            var btn = document.getElementById('the-button');
            var status = document.getElementById('status-text');

            status.innerText = "";

            if (currentUser === "Sergei") {
                btn.innerText = "RESET CYCLE";
            } else {
                btn.className = "btn-ready";
                btn.innerText = "ОТВЕТИТЬ!";
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>